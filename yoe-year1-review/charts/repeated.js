'use strict';

import { dateTime } from '/yoe-year1-review/js/utils/datetime.js';

const strokeData = [
    {
        "id": 40524237,
        "data": [
            [ {"d":28,"p":1225,"spm":0,"t":6},{"d":119,"p":1225,"spm":0,"t":27},{"d":212,"p":1134,"spm":27,"t":48},{"d":309,"p":1105,"spm":28,"t":68},{"d":437,"p":1028,"spm":27,"t":94},{"d":536,"p":1028,"spm":27,"t":115},{"d":634,"p":1039,"spm":26,"t":135},{"d":733,"p":1045,"spm":27,"t":156},{"d":863,"p":1018,"spm":27,"t":182},{"d":964,"p":1018,"spm":27,"t":202},{"d":1065,"p":1016,"spm":29,"t":223},{"d":1165,"p":1022,"spm":27,"t":243},{"d":1265,"p":1026,"spm":28,"t":264},{"d":1397,"p":1003,"spm":28,"t":290}, ],
            [ {"d":28,"p":0,"spm":0,"t":6},{"d":104,"p":1162,"spm":0,"t":21},{"d":210,"p":995,"spm":32,"t":42},{"d":316,"p":984,"spm":33,"t":63},{"d":421,"p":984,"spm":30,"t":83},{"d":527,"p":987,"spm":30,"t":104},{"d":631,"p":980,"spm":29,"t":125},{"d":735,"p":992,"spm":28,"t":145},{"d":838,"p":995,"spm":28,"t":166},{"d":942,"p":997,"spm":28,"t":187},{"d":1074,"p":998,"spm":28,"t":212},{"d":1176,"p":998,"spm":28,"t":233},{"d":1280,"p":999,"spm":28,"t":254},{"d":1383,"p":997,"spm":28,"t":274},{"d":1484,"p":1004,"spm":28,"t":295}, ],
            [ {"d":15,"p":0,"spm":0,"t":2},{"d":89,"p":994,"spm":0,"t":18},{"d":194,"p":1020,"spm":34,"t":39},{"d":298,"p":995,"spm":30,"t":59},{"d":400,"p":997,"spm":29,"t":80},{"d":504,"p":1004,"spm":28,"t":101},{"d":633,"p":999,"spm":28,"t":126},{"d":734,"p":1012,"spm":26,"t":147},{"d":864,"p":1013,"spm":25,"t":173},{"d":966,"p":1013,"spm":25,"t":193},{"d":1095,"p":1015,"spm":26,"t":219},{"d":1197,"p":1015,"spm":26,"t":240},{"d":1299,"p":1010,"spm":28,"t":260},{"d":1400,"p":1014,"spm":28,"t":281},{"d":1500,"p":1020,"spm":28,"t":301}, ],
            [ {"d":10,"p":0,"spm":0,"t":2},{"d":111,"p":1142,"spm":0,"t":23},{"d":215,"p":1022,"spm":31,"t":44},{"d":318,"p":1001,"spm":30,"t":64},{"d":420,"p":999,"spm":29,"t":85},{"d":523,"p":1011,"spm":28,"t":106},{"d":625,"p":1011,"spm":28,"t":126},{"d":754,"p":1020,"spm":27,"t":152},{"d":854,"p":1020,"spm":27,"t":173},{"d":955,"p":1022,"spm":27,"t":193},{"d":1082,"p":1022,"spm":27,"t":219},{"d":1182,"p":1029,"spm":27,"t":240},{"d":1309,"p":1040,"spm":27,"t":265},{"d":1408,"p":1039,"spm":28,"t":286}, ],
            [ {"d":31,"p":1156,"spm":0,"t":7},{"d":104,"p":1156,"spm":0,"t":22},{"d":204,"p":1038,"spm":31,"t":43},{"d":331,"p":1031,"spm":28,"t":68},{"d":432,"p":1029,"spm":26,"t":89},{"d":562,"p":1015,"spm":27,"t":115},{"d":662,"p":1015,"spm":27,"t":135},{"d":764,"p":1015,"spm":27,"t":156},{"d":894,"p":1012,"spm":27,"t":182},{"d":995,"p":1012,"spm":27,"t":202},{"d":1097,"p":1011,"spm":27,"t":223},{"d":1200,"p":1009,"spm":27,"t":244},{"d":1331,"p":1000,"spm":28,"t":270},{"d":1433,"p":1000,"spm":28,"t":290}, ],
            [ {"d":10,"p":0,"spm":0,"t":2},{"d":114,"p":1128,"spm":0,"t":23},{"d":213,"p":1006,"spm":33,"t":44},{"d":311,"p":1036,"spm":28,"t":64},{"d":440,"p":1019,"spm":28,"t":90},{"d":541,"p":1018,"spm":28,"t":111},{"d":644,"p":1016,"spm":29,"t":131},{"d":745,"p":1016,"spm":29,"t":152},{"d":848,"p":1014,"spm":28,"t":172},{"d":951,"p":1007,"spm":29,"t":193},{"d":1054,"p":1001,"spm":29,"t":214},{"d":1157,"p":1006,"spm":28,"t":234},{"d":1260,"p":999,"spm":29,"t":255},{"d":1363,"p":1006,"spm":28,"t":276},{"d":1466,"p":1000,"spm":28,"t":296}, ],
            [ {"d":19,"p":0,"spm":0,"t":4},{"d":119,"p":1055,"spm":0,"t":24},{"d":221,"p":1031,"spm":29,"t":45},{"d":321,"p":1019,"spm":29,"t":66},{"d":423,"p":1021,"spm":28,"t":86},{"d":526,"p":1014,"spm":29,"t":107},{"d":629,"p":1007,"spm":29,"t":127},{"d":734,"p":1001,"spm":29,"t":148},{"d":838,"p":994,"spm":29,"t":169},{"d":969,"p":1004,"spm":27,"t":194},{"d":1068,"p":1004,"spm":27,"t":215},{"d":1166,"p":1033,"spm":27,"t":236},{"d":1266,"p":1047,"spm":28,"t":256},{"d":1395,"p":1023,"spm":28,"t":282},{"d":1492,"p":1042,"spm":28,"t":321}, ],
            [ {"d":22,"p":0,"spm":0,"t":4},{"d":96,"p":1088,"spm":0,"t":20},{"d":197,"p":1034,"spm":33,"t":41},{"d":299,"p":1024,"spm":30,"t":61},{"d":403,"p":1007,"spm":29,"t":82},{"d":534,"p":1002,"spm":28,"t":108},{"d":636,"p":1002,"spm":28,"t":128},{"d":739,"p":1008,"spm":28,"t":149},{"d":840,"p":1005,"spm":28,"t":169},{"d":942,"p":1013,"spm":28,"t":190},{"d":1072,"p":1008,"spm":28,"t":216},{"d":1174,"p":1008,"spm":28,"t":237},{"d":1274,"p":1016,"spm":28,"t":257},{"d":1403,"p":1021,"spm":27,"t":283},{"d":1498,"p":1068,"spm":27,"t":321}, ],
            [ {"d":5,"p":0,"spm":0,"t":1},{"d":104,"p":1037,"spm":0,"t":21},{"d":203,"p":1052,"spm":32,"t":42},{"d":305,"p":1047,"spm":29,"t":63},{"d":406,"p":1019,"spm":28,"t":83},{"d":509,"p":1014,"spm":28,"t":104},{"d":612,"p":1009,"spm":29,"t":125},{"d":715,"p":1003,"spm":29,"t":145},{"d":819,"p":1004,"spm":28,"t":166},{"d":949,"p":1013,"spm":28,"t":192},{"d":1052,"p":1008,"spm":29,"t":212},{"d":1154,"p":1013,"spm":28,"t":233},{"d":1255,"p":1011,"spm":28,"t":254},{"d":1358,"p":1011,"spm":28,"t":274},{"d":1460,"p":1006,"spm":28,"t":295}, ],
            [ {"d":11,"p":0,"spm":0,"t":2},{"d":114,"p":1061,"spm":0,"t":23},{"d":215,"p":1017,"spm":32,"t":44},{"d":314,"p":1029,"spm":30,"t":64},{"d":415,"p":1031,"spm":27,"t":85},{"d":543,"p":1028,"spm":28,"t":111},{"d":645,"p":1028,"spm":28,"t":131},{"d":746,"p":1017,"spm":28,"t":152},{"d":849,"p":1016,"spm":28,"t":172},{"d":951,"p":1007,"spm":30,"t":193},{"d":1053,"p":1013,"spm":28,"t":214},{"d":1155,"p":1015,"spm":29,"t":234},{"d":1258,"p":1007,"spm":28,"t":255},{"d":1360,"p":1005,"spm":29,"t":276},{"d":1463,"p":1011,"spm":28,"t":296}, ],
            [ {"d":20,"p":0,"spm":0,"t":4},{"d":96,"p":1016,"spm":0,"t":19},{"d":198,"p":1006,"spm":34,"t":40},{"d":300,"p":1016,"spm":30,"t":60},{"d":404,"p":1016,"spm":29,"t":81},{"d":506,"p":998,"spm":30,"t":102},{"d":608,"p":1010,"spm":28,"t":122},{"d":710,"p":1021,"spm":28,"t":143},{"d":842,"p":1004,"spm":28,"t":169},{"d":945,"p":1004,"spm":29,"t":189},{"d":1046,"p":1004,"spm":29,"t":210},{"d":1146,"p":1016,"spm":27,"t":231},{"d":1247,"p":1024,"spm":27,"t":251},{"d":1378,"p":1010,"spm":28,"t":277},{"d":1477,"p":1010,"spm":28,"t":298}, ],
            [ {"d":22,"p":1121,"spm":0,"t":5},{"d":94,"p":1121,"spm":0,"t":20},{"d":196,"p":1065,"spm":34,"t":41},{"d":295,"p":1021,"spm":30,"t":61},{"d":396,"p":1028,"spm":28,"t":82},{"d":523,"p":1034,"spm":27,"t":108},{"d":622,"p":1038,"spm":28,"t":128},{"d":722,"p":1038,"spm":28,"t":149},{"d":823,"p":1031,"spm":28,"t":170},{"d":922,"p":1029,"spm":28,"t":190},{"d":1023,"p":1030,"spm":28,"t":211},{"d":1153,"p":1012,"spm":28,"t":236},{"d":1256,"p":1007,"spm":28,"t":257},{"d":1360,"p":999,"spm":29,"t":278},{"d":1438,"p":999,"spm":29,"t":293}, ],
            [ {"d":30,"p":1042,"spm":0,"t":6},{"d":107,"p":1042,"spm":0,"t":21},{"d":209,"p":1005,"spm":35,"t":42},{"d":313,"p":1013,"spm":29,"t":63},{"d":415,"p":1004,"spm":29,"t":83},{"d":516,"p":1013,"spm":29,"t":104},{"d":619,"p":1013,"spm":28,"t":124},{"d":721,"p":1009,"spm":28,"t":145},{"d":852,"p":1013,"spm":27,"t":171},{"d":952,"p":1013,"spm":27,"t":191},{"d":1053,"p":1017,"spm":27,"t":212},{"d":1153,"p":1023,"spm":27,"t":233},{"d":1255,"p":1024,"spm":28,"t":253},{"d":1384,"p":1021,"spm":28,"t":279}, ],
            [ {"d":34,"p":1071,"spm":0,"t":7},{"d":111,"p":1071,"spm":0,"t":22},{"d":213,"p":996,"spm":33,"t":43},{"d":315,"p":1010,"spm":29,"t":63},{"d":442,"p":1034,"spm":27,"t":89},{"d":541,"p":1034,"spm":27,"t":110},{"d":640,"p":1035,"spm":26,"t":130},{"d":742,"p":1035,"spm":27,"t":151},{"d":873,"p":1007,"spm":28,"t":177},{"d":974,"p":1014,"spm":27,"t":197},{"d":1075,"p":1014,"spm":27,"t":218},{"d":1176,"p":1018,"spm":27,"t":239},{"d":1305,"p":1016,"spm":27,"t":264},{"d":1408,"p":1003,"spm":29,"t":285}, ],
            [ {"d":30,"p":1201,"spm":0,"t":7},{"d":102,"p":1201,"spm":0,"t":22},{"d":228,"p":1043,"spm":27,"t":48},{"d":326,"p":1043,"spm":27,"t":68},{"d":426,"p":1039,"spm":26,"t":89},{"d":528,"p":1030,"spm":27,"t":110},{"d":660,"p":997,"spm":29,"t":135},{"d":764,"p":993,"spm":28,"t":156},{"d":868,"p":989,"spm":28,"t":177},{"d":973,"p":989,"spm":28,"t":197},{"d":1077,"p":983,"spm":28,"t":218},{"d":1181,"p":995,"spm":28,"t":239},{"d":1284,"p":992,"spm":29,"t":259},{"d":1417,"p":1001,"spm":28,"t":285},{"d":1516,"p":1029,"spm":28,"t":321}, ],
            [ {"d":16,"p":0,"spm":0,"t":3},{"d":93,"p":980,"spm":0,"t":18},{"d":196,"p":995,"spm":33,"t":39},{"d":301,"p":1003,"spm":29,"t":60},{"d":433,"p":991,"spm":28,"t":85},{"d":536,"p":991,"spm":28,"t":106},{"d":639,"p":1001,"spm":28,"t":127},{"d":742,"p":996,"spm":28,"t":147},{"d":844,"p":1005,"spm":28,"t":168},{"d":947,"p":1011,"spm":28,"t":188},{"d":1078,"p":1002,"spm":28,"t":214},{"d":1182,"p":995,"spm":28,"t":235},{"d":1286,"p":995,"spm":28,"t":255},{"d":1390,"p":996,"spm":28,"t":276},{"d":1492,"p":996,"spm":28,"t":297}, ],
            [ {"d":10,"p":0,"spm":0,"t":2},{"d":89,"p":1157,"spm":0,"t":18},{"d":193,"p":968,"spm":40,"t":39},{"d":298,"p":990,"spm":30,"t":59},{"d":404,"p":989,"spm":30,"t":80},{"d":509,"p":984,"spm":30,"t":100},{"d":613,"p":994,"spm":30,"t":121},{"d":718,"p":986,"spm":30,"t":142},{"d":824,"p":980,"spm":30,"t":162},{"d":930,"p":978,"spm":30,"t":183},{"d":1036,"p":980,"spm":29,"t":204},{"d":1142,"p":983,"spm":29,"t":224},{"d":1219,"p":983,"spm":29,"t":240},{"d":1327,"p":972,"spm":30,"t":260},{"d":1433,"p":965,"spm":30,"t":281},{"d":1539,"p":974,"spm":30,"t":302}, ],
            [ {"d":32,"p":1169,"spm":0,"t":7},{"d":111,"p":1169,"spm":0,"t":22},{"d":188,"p":983,"spm":36,"t":38},{"d":295,"p":984,"spm":34,"t":58},{"d":401,"p":975,"spm":30,"t":79},{"d":507,"p":982,"spm":30,"t":100},{"d":612,"p":976,"spm":30,"t":120},{"d":718,"p":985,"spm":29,"t":141},{"d":824,"p":983,"spm":29,"t":162},{"d":929,"p":977,"spm":29,"t":182},{"d":1036,"p":979,"spm":29,"t":203},{"d":1141,"p":978,"spm":29,"t":223},{"d":1247,"p":979,"spm":29,"t":244},{"d":1352,"p":977,"spm":29,"t":265},{"d":1457,"p":983,"spm":29,"t":285}, ],
            [ {"d":18,"p":0,"spm":0,"t":3},{"d":97,"p":992,"spm":0,"t":19},{"d":176,"p":980,"spm":39,"t":34},{"d":287,"p":962,"spm":33,"t":55},{"d":394,"p":952,"spm":31,"t":75},{"d":502,"p":969,"spm":31,"t":96},{"d":608,"p":973,"spm":29,"t":117},{"d":715,"p":978,"spm":29,"t":137},{"d":820,"p":980,"spm":29,"t":158},{"d":897,"p":980,"spm":29,"t":173},{"d":1004,"p":975,"spm":30,"t":194},{"d":1112,"p":967,"spm":30,"t":215},{"d":1218,"p":972,"spm":30,"t":235},{"d":1325,"p":974,"spm":30,"t":256},{"d":1432,"p":975,"spm":30,"t":276},{"d":1538,"p":979,"spm":30,"t":297}, ],
            [ {"d":10,"p":0,"spm":0,"t":2},{"d":90,"p":1121,"spm":0,"t":18},{"d":197,"p":972,"spm":39,"t":39},{"d":305,"p":964,"spm":32,"t":59},{"d":412,"p":974,"spm":31,"t":80},{"d":518,"p":982,"spm":30,"t":101},{"d":596,"p":982,"spm":30,"t":116},{"d":704,"p":967,"spm":31,"t":137},{"d":811,"p":968,"spm":30,"t":157},{"d":917,"p":973,"spm":31,"t":178},{"d":1024,"p":975,"spm":30,"t":198},{"d":1131,"p":970,"spm":30,"t":219},{"d":1238,"p":967,"spm":30,"t":240},{"d":1346,"p":966,"spm":30,"t":260},{"d":1452,"p":976,"spm":30,"t":281},{"d":1530,"p":976,"spm":30,"t":296}, ],
            [ {"d":0,"p":0,"spm":0,"t":0},{"d":102,"p":1011,"spm":36,"t":20},{"d":179,"p":1011,"spm":36,"t":35},{"d":288,"p":986,"spm":31,"t":56},{"d":396,"p":964,"spm":31,"t":77},{"d":503,"p":968,"spm":30,"t":97},{"d":611,"p":963,"spm":30,"t":118},{"d":689,"p":963,"spm":30,"t":133},{"d":798,"p":961,"spm":30,"t":154},{"d":905,"p":957,"spm":30,"t":175},{"d":1013,"p":965,"spm":30,"t":195},{"d":1121,"p":964,"spm":29,"t":216},{"d":1228,"p":963,"spm":29,"t":236},{"d":1335,"p":967,"spm":30,"t":257},{"d":1443,"p":970,"spm":30,"t":278},{"d":1549,"p":964,"spm":30,"t":298}, ],
            [ {"d":13,"p":0,"spm":0,"t":3},{"d":93,"p":1136,"spm":0,"t":19},{"d":202,"p":965,"spm":34,"t":39},{"d":281,"p":965,"spm":34,"t":55},{"d":390,"p":958,"spm":33,"t":75},{"d":500,"p":960,"spm":32,"t":96},{"d":579,"p":960,"spm":32,"t":111},{"d":688,"p":953,"spm":33,"t":132},{"d":796,"p":962,"spm":31,"t":153},{"d":906,"p":954,"spm":31,"t":173},{"d":985,"p":954,"spm":31,"t":189},{"d":1093,"p":952,"spm":30,"t":209},{"d":1200,"p":960,"spm":30,"t":230},{"d":1308,"p":968,"spm":30,"t":251},{"d":1415,"p":971,"spm":30,"t":271},{"d":1522,"p":970,"spm":30,"t":292}, ],
            [ {"d":33,"p":1136,"spm":0,"t":7},{"d":110,"p":1008,"spm":37,"t":22},{"d":189,"p":1008,"spm":37,"t":38},{"d":297,"p":970,"spm":33,"t":58},{"d":376,"p":970,"spm":33,"t":74},{"d":483,"p":965,"spm":32,"t":95},{"d":590,"p":971,"spm":31,"t":115},{"d":699,"p":963,"spm":31,"t":136},{"d":778,"p":963,"spm":31,"t":151},{"d":885,"p":964,"spm":31,"t":172},{"d":995,"p":955,"spm":32,"t":192},{"d":1075,"p":955,"spm":32,"t":208},{"d":1183,"p":961,"spm":31,"t":229},{"d":1292,"p":959,"spm":32,"t":249},{"d":1400,"p":962,"spm":32,"t":270},{"d":1479,"p":962,"spm":32,"t":285}, ],
            [ {"d":28,"p":0,"spm":0,"t":6},{"d":107,"p":1195,"spm":0,"t":22},{"d":189,"p":981,"spm":38,"t":37},{"d":304,"p":938,"spm":34,"t":58},{"d":389,"p":907,"spm":33,"t":73},{"d":503,"p":906,"spm":33,"t":94},{"d":618,"p":909,"spm":32,"t":115},{"d":703,"p":909,"spm":32,"t":130},{"d":819,"p":900,"spm":32,"t":151},{"d":905,"p":899,"spm":33,"t":166},{"d":993,"p":893,"spm":37,"t":182},{"d":1111,"p":890,"spm":35,"t":202},{"d":1197,"p":890,"spm":35,"t":218},{"d":1285,"p":889,"spm":34,"t":233},{"d":1375,"p":871,"spm":38,"t":249},{"d":1496,"p":869,"spm":36,"t":269},{"d":1584,"p":869,"spm":36,"t":285},{"d":1672,"p":872,"spm":36,"t":300} ]
        ]
    },

    {
        "id": 46414252,
        "data": [
            [ {"d":97,"p":1095,"spm":0,"t":19},{"d":206,"p":951,"spm":36,"t":40},{"d":315,"p":959,"spm":31,"t":60},{"d":422,"p":957,"spm":31,"t":81},{"d":528,"p":960,"spm":29,"t":102},{"d":662,"p":983,"spm":27,"t":127},{"d":767,"p":983,"spm":27,"t":148},{"d":868,"p":980,"spm":27,"t":169},{"d":999,"p":1006,"spm":26,"t":194},{"d":1100,"p":1006,"spm":26,"t":215},{"d":1229,"p":1019,"spm":25,"t":241},{"d":1328,"p":1019,"spm":25,"t":261},{"d":1456,"p":1021,"spm":25,"t":287}, ],
            [ {"d":19,"p":0,"spm":0,"t":4},{"d":125,"p":1094,"spm":0,"t":25},{"d":225,"p":979,"spm":31,"t":45},{"d":325,"p":1028,"spm":27,"t":66},{"d":457,"p":1027,"spm":27,"t":92},{"d":560,"p":994,"spm":27,"t":113},{"d":689,"p":996,"spm":26,"t":138},{"d":791,"p":1013,"spm":26,"t":159},{"d":923,"p":1000,"spm":26,"t":185},{"d":1023,"p":1000,"spm":26,"t":205},{"d":1150,"p":1013,"spm":25,"t":231},{"d":1250,"p":1024,"spm":25,"t":252},{"d":1379,"p":1024,"spm":25,"t":278},{"d":1482,"p":1015,"spm":26,"t":298}, ],
            [ {"d":30,"p":1150,"spm":0,"t":6},{"d":108,"p":1150,"spm":0,"t":22},{"d":213,"p":1000,"spm":36,"t":43},{"d":314,"p":989,"spm":28,"t":63},{"d":441,"p":1013,"spm":26,"t":89},{"d":570,"p":1023,"spm":26,"t":115},{"d":671,"p":1023,"spm":26,"t":135},{"d":774,"p":1011,"spm":26,"t":156},{"d":905,"p":990,"spm":26,"t":182},{"d":1008,"p":1000,"spm":26,"t":202},{"d":1139,"p":998,"spm":26,"t":228},{"d":1240,"p":998,"spm":26,"t":249},{"d":1371,"p":1007,"spm":26,"t":275},{"d":1473,"p":1003,"spm":26,"t":295}, ],
            [ {"d":13,"p":0,"spm":0,"t":3},{"d":118,"p":1038,"spm":0,"t":23},{"d":221,"p":984,"spm":30,"t":44},{"d":351,"p":1003,"spm":27,"t":70},{"d":451,"p":1012,"spm":26,"t":90},{"d":580,"p":1015,"spm":26,"t":116},{"d":680,"p":1015,"spm":26,"t":137},{"d":810,"p":1014,"spm":26,"t":162},{"d":912,"p":1014,"spm":26,"t":183},{"d":1043,"p":1000,"spm":26,"t":209},{"d":1143,"p":1000,"spm":26,"t":229},{"d":1274,"p":1004,"spm":26,"t":255},{"d":1375,"p":1004,"spm":26,"t":276},{"d":1505,"p":1009,"spm":26,"t":323}, ],
            [ {"d":14,"p":0,"spm":0,"t":3},{"d":117,"p":1110,"spm":0,"t":24},{"d":246,"p":1026,"spm":27,"t":50},{"d":343,"p":1026,"spm":27,"t":70},{"d":470,"p":1037,"spm":25,"t":96},{"d":575,"p":1031,"spm":26,"t":117},{"d":710,"p":980,"spm":27,"t":143},{"d":812,"p":980,"spm":27,"t":163},{"d":914,"p":991,"spm":26,"t":184},{"d":1046,"p":1000,"spm":26,"t":210},{"d":1148,"p":997,"spm":26,"t":230},{"d":1280,"p":1003,"spm":26,"t":256},{"d":1381,"p":1003,"spm":26,"t":277},{"d":1508,"p":1029,"spm":26,"t":323}, ],
            [ {"d":1,"p":0,"spm":0,"t":0},{"d":106,"p":933,"spm":0,"t":20},{"d":207,"p":987,"spm":31,"t":41},{"d":336,"p":1020,"spm":28,"t":67},{"d":437,"p":1020,"spm":28,"t":87},{"d":538,"p":1021,"spm":27,"t":108},{"d":640,"p":1013,"spm":27,"t":129},{"d":771,"p":1004,"spm":27,"t":154},{"d":873,"p":1004,"spm":27,"t":175},{"d":1003,"p":1010,"spm":26,"t":201},{"d":1105,"p":1010,"spm":26,"t":222},{"d":1206,"p":1011,"spm":27,"t":242},{"d":1337,"p":1008,"spm":26,"t":268},{"d":1439,"p":1008,"spm":26,"t":289}, ],
            [ {"d":13,"p":0,"spm":0,"t":3},{"d":115,"p":1143,"spm":0,"t":24},{"d":215,"p":1017,"spm":31,"t":44},{"d":345,"p":1017,"spm":27,"t":70},{"d":447,"p":1017,"spm":27,"t":91},{"d":548,"p":1008,"spm":27,"t":111},{"d":679,"p":1010,"spm":26,"t":137},{"d":779,"p":1010,"spm":26,"t":158},{"d":911,"p":1006,"spm":27,"t":184},{"d":1013,"p":1006,"spm":27,"t":204},{"d":1116,"p":1000,"spm":27,"t":225},{"d":1218,"p":1001,"spm":27,"t":245},{"d":1350,"p":1000,"spm":27,"t":271},{"d":1450,"p":1003,"spm":27,"t":292}, ],
            [ {"d":31,"p":0,"spm":0,"t":6},{"d":110,"p":1102,"spm":0,"t":22},{"d":240,"p":1009,"spm":27,"t":48},{"d":340,"p":1009,"spm":27,"t":68},{"d":469,"p":1025,"spm":27,"t":94},{"d":569,"p":1025,"spm":27,"t":115},{"d":669,"p":1020,"spm":26,"t":135},{"d":803,"p":991,"spm":28,"t":161},{"d":909,"p":966,"spm":28,"t":182},{"d":1013,"p":966,"spm":28,"t":202},{"d":1117,"p":986,"spm":27,"t":223},{"d":1249,"p":997,"spm":27,"t":249},{"d":1352,"p":997,"spm":27,"t":269},{"d":1453,"p":993,"spm":27,"t":290}, ],
            [ {"d":10,"p":0,"spm":0,"t":2},{"d":115,"p":1071,"spm":0,"t":23},{"d":243,"p":1022,"spm":27,"t":49},{"d":345,"p":1022,"spm":27,"t":69},{"d":449,"p":1015,"spm":27,"t":90},{"d":580,"p":1002,"spm":26,"t":116},{"d":682,"p":1002,"spm":26,"t":136},{"d":783,"p":1007,"spm":26,"t":157},{"d":913,"p":1007,"spm":27,"t":183},{"d":1014,"p":1008,"spm":26,"t":203},{"d":1144,"p":1011,"spm":26,"t":229},{"d":1244,"p":1015,"spm":26,"t":250},{"d":1374,"p":1016,"spm":26,"t":276},{"d":1473,"p":1016,"spm":26,"t":296}, ],
            [ {"d":25,"p":923,"spm":0,"t":4},{"d":103,"p":923,"spm":0,"t":20},{"d":236,"p":992,"spm":28,"t":45},{"d":339,"p":992,"spm":28,"t":66},{"d":442,"p":997,"spm":27,"t":87},{"d":572,"p":1010,"spm":26,"t":112},{"d":673,"p":1010,"spm":26,"t":133},{"d":775,"p":1013,"spm":26,"t":154},{"d":904,"p":1007,"spm":27,"t":179},{"d":1004,"p":1016,"spm":26,"t":200},{"d":1133,"p":1019,"spm":26,"t":226},{"d":1234,"p":1014,"spm":26,"t":246},{"d":1364,"p":1011,"spm":27,"t":272},{"d":1465,"p":1011,"spm":27,"t":293}, ],
            [ {"d":30,"p":980,"spm":0,"t":5},{"d":137,"p":975,"spm":29,"t":26},{"d":240,"p":975,"spm":29,"t":47},{"d":342,"p":994,"spm":27,"t":67},{"d":476,"p":989,"spm":27,"t":93},{"d":580,"p":989,"spm":27,"t":114},{"d":684,"p":980,"spm":27,"t":134},{"d":816,"p":992,"spm":26,"t":160},{"d":918,"p":992,"spm":26,"t":181},{"d":1048,"p":1001,"spm":26,"t":207},{"d":1149,"p":1010,"spm":26,"t":227},{"d":1278,"p":1006,"spm":26,"t":253},{"d":1377,"p":1014,"spm":26,"t":274},{"d":1503,"p":1024,"spm":26,"t":299}, ],
            [ {"d":11,"p":0,"spm":0,"t":2},{"d":115,"p":984,"spm":0,"t":23},{"d":215,"p":999,"spm":30,"t":43},{"d":344,"p":1023,"spm":27,"t":69},{"d":446,"p":1023,"spm":27,"t":90},{"d":549,"p":1008,"spm":27,"t":110},{"d":651,"p":1003,"spm":28,"t":131},{"d":781,"p":1011,"spm":27,"t":157},{"d":882,"p":1011,"spm":27,"t":177},{"d":985,"p":1012,"spm":26,"t":198},{"d":1117,"p":997,"spm":28,"t":224},{"d":1221,"p":991,"spm":28,"t":244},{"d":1325,"p":991,"spm":28,"t":265},{"d":1426,"p":988,"spm":27,"t":286}, ],
            [ {"d":16,"p":0,"spm":0,"t":3},{"d":120,"p":1016,"spm":0,"t":24},{"d":219,"p":1006,"spm":30,"t":44},{"d":349,"p":1015,"spm":27,"t":70},{"d":451,"p":1015,"spm":27,"t":91},{"d":553,"p":1000,"spm":27,"t":111},{"d":681,"p":1013,"spm":26,"t":137},{"d":784,"p":1017,"spm":26,"t":158},{"d":919,"p":978,"spm":27,"t":184},{"d":1023,"p":978,"spm":27,"t":204},{"d":1127,"p":988,"spm":27,"t":225},{"d":1230,"p":989,"spm":27,"t":246},{"d":1363,"p":992,"spm":27,"t":271},{"d":1467,"p":992,"spm":27,"t":292}, ],
            [ {"d":23,"p":0,"spm":0,"t":4},{"d":131,"p":970,"spm":30,"t":25},{"d":233,"p":970,"spm":30,"t":46},{"d":336,"p":1005,"spm":28,"t":66},{"d":438,"p":1008,"spm":28,"t":87},{"d":540,"p":1007,"spm":27,"t":107},{"d":672,"p":1001,"spm":28,"t":133},{"d":774,"p":1001,"spm":28,"t":154},{"d":878,"p":998,"spm":28,"t":175},{"d":981,"p":1000,"spm":28,"t":195},{"d":1113,"p":1005,"spm":27,"t":221},{"d":1214,"p":1005,"spm":27,"t":242},{"d":1316,"p":1008,"spm":27,"t":262},{"d":1418,"p":1009,"spm":27,"t":283}, ],
            [ {"d":13,"p":0,"spm":0,"t":3},{"d":121,"p":1102,"spm":0,"t":24},{"d":223,"p":969,"spm":32,"t":44},{"d":324,"p":1010,"spm":28,"t":65},{"d":429,"p":1013,"spm":28,"t":86},{"d":562,"p":992,"spm":29,"t":111},{"d":666,"p":996,"spm":28,"t":132},{"d":770,"p":996,"spm":28,"t":153},{"d":873,"p":992,"spm":28,"t":173},{"d":976,"p":996,"spm":27,"t":194},{"d":1081,"p":994,"spm":27,"t":215},{"d":1213,"p":994,"spm":28,"t":240},{"d":1317,"p":994,"spm":28,"t":261},{"d":1419,"p":996,"spm":27,"t":282},{"d":1548,"p":1021,"spm":27,"t":323}, ],
            [ {"d":17,"p":0,"spm":0,"t":4},{"d":126,"p":1075,"spm":0,"t":24},{"d":230,"p":956,"spm":33,"t":45},{"d":333,"p":994,"spm":28,"t":66},{"d":436,"p":1006,"spm":28,"t":86},{"d":541,"p":995,"spm":29,"t":107},{"d":647,"p":982,"spm":28,"t":128},{"d":751,"p":981,"spm":29,"t":148},{"d":885,"p":987,"spm":29,"t":174},{"d":989,"p":991,"spm":28,"t":195},{"d":1093,"p":996,"spm":29,"t":215},{"d":1196,"p":996,"spm":29,"t":236},{"d":1299,"p":999,"spm":28,"t":256},{"d":1402,"p":1001,"spm":28,"t":277},{"d":1505,"p":998,"spm":28,"t":298}, ],
            [ {"d":4,"p":0,"spm":0,"t":0},{"d":109,"p":931,"spm":0,"t":21},{"d":213,"p":987,"spm":32,"t":41},{"d":317,"p":1000,"spm":29,"t":62},{"d":420,"p":1000,"spm":29,"t":83},{"d":523,"p":996,"spm":29,"t":103},{"d":627,"p":999,"spm":28,"t":124},{"d":730,"p":1001,"spm":29,"t":145},{"d":834,"p":998,"spm":29,"t":165},{"d":936,"p":1004,"spm":28,"t":186},{"d":1069,"p":996,"spm":28,"t":212},{"d":1173,"p":991,"spm":28,"t":232},{"d":1278,"p":991,"spm":28,"t":253},{"d":1381,"p":989,"spm":28,"t":274},{"d":1485,"p":995,"spm":28,"t":294}, ],
            [ {"d":22,"p":0,"spm":0,"t":5},{"d":129,"p":976,"spm":33,"t":26},{"d":233,"p":1008,"spm":30,"t":47},{"d":336,"p":1005,"spm":29,"t":67},{"d":439,"p":994,"spm":29,"t":88},{"d":545,"p":985,"spm":29,"t":108},{"d":649,"p":991,"spm":29,"t":129},{"d":753,"p":991,"spm":29,"t":150},{"d":858,"p":993,"spm":28,"t":170},{"d":963,"p":985,"spm":30,"t":191},{"d":1067,"p":985,"spm":30,"t":212},{"d":1170,"p":993,"spm":28,"t":232},{"d":1274,"p":996,"spm":28,"t":253},{"d":1378,"p":993,"spm":29,"t":273},{"d":1483,"p":990,"spm":29,"t":294}, ],
            [ {"d":14,"p":0,"spm":0,"t":2},{"d":92,"p":0,"spm":0,"t":18},{"d":198,"p":972,"spm":32,"t":38},{"d":303,"p":980,"spm":30,"t":59},{"d":408,"p":989,"spm":29,"t":79},{"d":510,"p":990,"spm":29,"t":100},{"d":614,"p":1002,"spm":29,"t":121},{"d":718,"p":1001,"spm":29,"t":141},{"d":822,"p":994,"spm":28,"t":162},{"d":955,"p":996,"spm":28,"t":188},{"d":1059,"p":991,"spm":29,"t":208},{"d":1163,"p":991,"spm":28,"t":229},{"d":1267,"p":991,"spm":28,"t":250},{"d":1370,"p":996,"spm":28,"t":270},{"d":1473,"p":995,"spm":28,"t":291}, ],
            [ {"d":13,"p":0,"spm":0,"t":3},{"d":118,"p":1070,"spm":0,"t":24},{"d":220,"p":992,"spm":33,"t":44},{"d":323,"p":1014,"spm":28,"t":65},{"d":426,"p":1007,"spm":29,"t":85},{"d":530,"p":1000,"spm":28,"t":106},{"d":663,"p":995,"spm":28,"t":132},{"d":767,"p":988,"spm":28,"t":153},{"d":872,"p":988,"spm":28,"t":173},{"d":977,"p":983,"spm":29,"t":194},{"d":1082,"p":986,"spm":29,"t":214},{"d":1188,"p":984,"spm":29,"t":235},{"d":1293,"p":978,"spm":29,"t":256},{"d":1398,"p":985,"spm":28,"t":276},{"d":1502,"p":984,"spm":29,"t":297}, ],
            [ {"d":30,"p":0,"spm":0,"t":6},{"d":109,"p":1151,"spm":0,"t":22},{"d":218,"p":962,"spm":33,"t":43},{"d":325,"p":971,"spm":30,"t":63},{"d":430,"p":984,"spm":29,"t":84},{"d":507,"p":984,"spm":29,"t":99},{"d":612,"p":983,"spm":30,"t":120},{"d":717,"p":983,"spm":30,"t":141},{"d":822,"p":984,"spm":29,"t":161},{"d":928,"p":982,"spm":29,"t":182},{"d":1034,"p":982,"spm":29,"t":202},{"d":1139,"p":982,"spm":30,"t":223},{"d":1244,"p":985,"spm":29,"t":244},{"d":1348,"p":989,"spm":29,"t":264},{"d":1453,"p":992,"spm":29,"t":285}, ],
            [ {"d":34,"p":1114,"spm":0,"t":7},{"d":111,"p":1114,"spm":0,"t":23},{"d":214,"p":993,"spm":34,"t":43},{"d":318,"p":1004,"spm":30,"t":64},{"d":424,"p":997,"spm":29,"t":84},{"d":529,"p":987,"spm":30,"t":105},{"d":632,"p":988,"spm":29,"t":126},{"d":736,"p":997,"spm":29,"t":146},{"d":841,"p":988,"spm":29,"t":167},{"d":947,"p":981,"spm":29,"t":187},{"d":1054,"p":976,"spm":29,"t":208},{"d":1160,"p":972,"spm":30,"t":229},{"d":1267,"p":971,"spm":30,"t":249},{"d":1344,"p":971,"spm":30,"t":265},{"d":1449,"p":983,"spm":29,"t":285}, ],
            [ {"d":20,"p":0,"spm":0,"t":5},{"d":128,"p":973,"spm":34,"t":25},{"d":205,"p":973,"spm":34,"t":41},{"d":311,"p":981,"spm":31,"t":61},{"d":416,"p":986,"spm":30,"t":82},{"d":524,"p":979,"spm":30,"t":103},{"d":631,"p":969,"spm":30,"t":123},{"d":738,"p":972,"spm":30,"t":144},{"d":816,"p":972,"spm":30,"t":159},{"d":922,"p":972,"spm":30,"t":180},{"d":1030,"p":972,"spm":30,"t":201},{"d":1137,"p":972,"spm":30,"t":221},{"d":1244,"p":967,"spm":30,"t":242},{"d":1351,"p":971,"spm":30,"t":262},{"d":1458,"p":972,"spm":30,"t":283},{"d":1562,"p":993,"spm":30,"t":320}, ],
            [ {"d":11,"p":0,"spm":0,"t":3},{"d":124,"p":932,"spm":37,"t":24},{"d":206,"p":932,"spm":37,"t":39},{"d":289,"p":935,"spm":34,"t":55},{"d":403,"p":923,"spm":34,"t":75},{"d":517,"p":919,"spm":32,"t":96},{"d":599,"p":919,"spm":32,"t":111},{"d":713,"p":917,"spm":32,"t":132},{"d":826,"p":922,"spm":32,"t":152},{"d":909,"p":922,"spm":32,"t":168},{"d":1023,"p":918,"spm":32,"t":189},{"d":1105,"p":920,"spm":32,"t":204},{"d":1219,"p":922,"spm":32,"t":225},{"d":1333,"p":918,"spm":32,"t":245},{"d":1416,"p":918,"spm":32,"t":261},{"d":1530,"p":919,"spm":32,"t":281},{"d":1613,"p":920,"spm":32,"t":297} ]
        ]
    }
];

/*
 * 24x0:30/0:30r
 * - 40524237
 * - 46414252
 */
const workouts = [
    {
        "id": 40524237,
        "description": "24x0:30/0:30r",
        "date":"2019-11-24",
        "distance":3624,
        "time":7200,
        "stroke_count":364,
        "intervals":[
            {"time":300,"distance":145,"stroke_rate":28},
            {"time":300,"distance":150,"stroke_rate":30},
            {"time":300,"distance":149,"stroke_rate":28},
            {"time":300,"distance":147,"stroke_rate":28},
            {"time":300,"distance":148,"stroke_rate":28},
            {"time":300,"distance":148,"stroke_rate":28},
            {"time":300,"distance":148,"stroke_rate":28},
            {"time":300,"distance":148,"stroke_rate":28},
            {"time":300,"distance":149,"stroke_rate":30},
            {"time":300,"distance":148,"stroke_rate":30},
            {"time":300,"distance":149,"stroke_rate":30},
            {"time":300,"distance":147,"stroke_rate":30},
            {"time":300,"distance":148,"stroke_rate":28},
            {"time":300,"distance":148,"stroke_rate":28},
            {"time":300,"distance":149,"stroke_rate":28},
            {"time":300,"distance":151,"stroke_rate":30},
            {"time":300,"distance":153,"stroke_rate":30},
            {"time":300,"distance":153,"stroke_rate":30},
            {"time":300,"distance":155,"stroke_rate":32},
            {"time":300,"distance":155,"stroke_rate":30},
            {"time":300,"distance":156,"stroke_rate":32},
            {"time":300,"distance":156,"stroke_rate":32},
            {"time":300,"distance":156,"stroke_rate":32},
            {"time":300,"distance":167,"stroke_rate":34},
        ]
    },
    {
        "id": 46414252,
        "description": "24x0:30/0:30r",
        "date":"2020-08-21",
        "distance":3631,
        "time":7200,
        "stroke_count":348,
        "intervals":[
            {"time":300,"distance":152,"stroke_rate":28},
            {"time":300,"distance":149,"stroke_rate":26},
            {"time":300,"distance":150,"stroke_rate":28},
            {"time":300,"distance":149,"stroke_rate":26},
            {"time":300,"distance":149,"stroke_rate":26},
            {"time":300,"distance":150,"stroke_rate":28},
            {"time":300,"distance":149,"stroke_rate":28},
            {"time":300,"distance":150,"stroke_rate":28},
            {"time":300,"distance":149,"stroke_rate":28},
            {"time":300,"distance":150,"stroke_rate":28},
            {"time":300,"distance":150,"stroke_rate":26},
            {"time":300,"distance":150,"stroke_rate":28},
            {"time":300,"distance":151,"stroke_rate":28},
            {"time":300,"distance":151,"stroke_rate":28},
            {"time":300,"distance":151,"stroke_rate":28},
            {"time":300,"distance":151,"stroke_rate":28},
            {"time":300,"distance":151,"stroke_rate":30},
            {"time":300,"distance":151,"stroke_rate":30},
            {"time":300,"distance":152,"stroke_rate":30},
            {"time":300,"distance":152,"stroke_rate":30},
            {"time":300,"distance":153,"stroke_rate":30},
            {"time":300,"distance":153,"stroke_rate":30},
            {"time":300,"distance":154,"stroke_rate":30},
            {"time":300,"distance":163,"stroke_rate":32},
        ]
    }
];

const strokesPerInterval = (ids) => {
    const dataset = [];
    const series = [];
    const yAxis = [];
    const xAxis = [];
    const legend = [];
    const tooltip = [];

    xAxis.push({
        type: 'value',
        name: 'Interval',
        nameGap: 30,
        nameLocation: 'middle',
    });

    legend.push({
        top: '10%',
    });

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Interval ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel + params.reduce((acc, val) => {
                return acc + `<br />${val.marker} ${val.value.numStrokes} strokes`;
            }, '');
        },
    });

    yAxis.push({
        name: 'Strokes',
        nameGap: 30,
        nameLocation: 'middle',
        min: 'dataMin',
    });

    ids.forEach((id, i) => {
        const workout = workouts.find((w) => w.id == id);

        dataset.push({
            dimension: [ 'interval', 'numStrokes' ],
            source: strokeData.find((sd) => sd.id == id).data.reduce((acc, val, interval) => {
                acc.push({
                    interval: interval+1,
                    numStrokes: val.length,
                });

                return acc;
            }, []),
        });

        series.push({
            type: 'line',
            name: workout.date,
            datasetIndex: i,
            symbolSize: 12,
            encode: {
                x: 'interval',
                y: 'numStrokes',
            },
            animation: false,
        });
    });

    return {
        legend,
        tooltip,
        xAxis,
        yAxis,
        dataset,
        series
    };
};

const distancePerInterval = (ids) => {
    const dataset = [];
    const series = [];
    const yAxis = [];
    const tooltip = [];
    const xAxis = [];
    const legend = [];

    xAxis.push({
        type: 'value',
        name: 'Interval',
        nameGap: 30,
        nameLocation: 'middle',
    });

    legend.push({
        top: '10%',
    });

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Interval ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel + params.reduce((acc, val) => {
                return acc + `<br />${val.marker} ${val.value.distance}m`;
            }, '');
        },
    });

    yAxis.push({
        name: 'Distance (m)',
        nameGap: 35,
        nameLocation: 'middle',
        min: 140,
    });

    ids.forEach((id, iw) => {
        const workout = workouts.find((w) => w.id == id);

        dataset.push({
            dimension: [ 'interval', 'distance' ],
            source: workout.intervals.map((w, i) => ({
                interval: i+1,
                distance: w.distance,
            })),
        });

        series.push({
            type: 'line',
            name: workout.date,
            datasetIndex: iw,
            encode: {
                x: 'interval',
                y: 'distance',
            },
            animation: false,
        });
    });

    return {
        tooltip,
        legend,
        xAxis,
        yAxis,
        dataset,
        series,
    };
};

const cumulativeDistancePerStroke = (ids) => {
    const dataset = [];
    const xAxis = [];
    const yAxis = [];
    const series = [];
    const tooltip = [];
    const legend = [];

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Stroke ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel + params.reduce((acc, val) => {
                return acc + `<br />${val.marker} ${(val.value.d / 10).toFixed(0)}m`;
            }, '');
        },
    });

    legend.push({
        top: '10%',
    });

    xAxis.push({
        name: 'Stroke',
        nameGap: 30,
        nameLocation: 'middle',
        max: 'dataMax',
    });
    yAxis.push({
        name: 'Cumulative distance / stroke (m)',
        nameGap: 40,
        nameLocation: 'middle',
        axisLabel: {
            formatter: (val) => (val / 10).toFixed(0),
        },
    });

    ids.forEach((id, iw) => {
        const workout = workouts.find((w) => w.id == id);
        const sd = strokeData.find((s) => s.id == id);
        let i = 1;

        dataset.push({
            dimension: [ 'stroke', 'd' ],
            source: sd.data.reduce((acc, val) => {
                return acc.concat(val.map((v) => {
                    return {
                        stroke: i++,
                        d: v.d,
                    };
                }));
            }, []),
        });

        series.push({
            type: 'bar',
            name: workout.date,
            datasetIndex: iw,
            showSymbol: false,
            lineStyle: {
                width: 1,
            },
            encode: {
                x: 'stroke',
                y: 'd',
            },
            animation: false,
        });
    });

    return {
        tooltip,
        legend,
        xAxis,
        yAxis,
        dataset,
        series,
    };
};

const distancePerStroke = (ids) => {
    const dataset = [];
    const xAxis = [];
    const yAxis = [];
    const series = [];
    const tooltip = [];
    const legend = [];

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Stroke ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel + params.reduce((acc, val) => {
                return acc + `<br />${val.marker} ${(val.value.d / 10).toFixed(0)}m`;
            }, '');
        },
    });

    legend.push({
        top: '10%',
    });

    xAxis.push({
        name: 'Stroke',
        nameGap: 30,
        nameLocation: 'middle',
        max: 'dataMax',
    });
    yAxis.push({
        name: 'Distance per stroke (m)',
        nameGap: 30,
        nameLocation: 'middle',
        axisLabel: {
            formatter: (val) => (val / 10).toFixed(0),
        },
    });

    ids.forEach((id, iw) => {
        const workout = workouts.find((w) => w.id == id);
        const sd = strokeData.find((s) => s.id == id);
        let i = 1;

        dataset.push({
            dimension: [ 'stroke', 'd' ],
            source: sd.data.reduce((acc, val) => {
                let lastDistance = 0;
                return acc.concat(val.map((v) => {
                    const d = v.d - lastDistance;
                    lastDistance = v.d;

                    return {
                        stroke: i++,
                        d: d,
                    };
                }));
            }, []),
        });

        series.push({
            type: 'line',
            name: workout.date,
            datasetIndex: iw,
            showSymbol: false,
            lineStyle: {
                width: 1,
            },
            encode: {
                x: 'stroke',
                y: 'distance',
            },
            animation: false,
        });
    });

    return {
        tooltip,
        legend,
        xAxis,
        yAxis,
        dataset,
        series,
    };
};

const distanceDeltaPerInterval = (ids) => {
    const dataset = [];
    const series = [];
    const yAxis = [];
    const xAxis = [];
    const legend = [];
    const tooltip = [];

    legend.push({
        top: '10%',
    });

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Interval ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel +
                `<br />${params[0].marker} ${params[0].value.delta}m`;
        },
    });

    xAxis.push({
        name: 'Interval',
        nameGap: 30,
        nameLocation: 'middle',
    });

    yAxis.push({
        name: 'Distance (m)',
        nameGap: 30,
        nameLocation: 'middle',
    });

    const numIntervals = workouts[0].intervals.length;
    const data = [];

    for (let i = 0; i < numIntervals; i++) {
        data.push({
            interval: i+1,
            delta: workouts[1].intervals[i].distance - workouts[0].intervals[i].distance,
        });
    }

    dataset.push({
        dimension: [ 'interval', 'delta' ],
        source: data,
    });

    series.push({
        type: 'bar',
        name: '2nd attempt vs 1st attempt baseline',
        encode: {
            x: 'interval',
            y: 'delta',
        },
        animation: false,
    });

    return {
        tooltip,
        legend,
        xAxis,
        yAxis,
        dataset,
        series
    };
};

const timeDeltaPerStroke = (ids) => {
    const dataset = [];
    const xAxis = [];
    const yAxis = [];
    const series = [];
    const tooltip = [];
    const legend = [];

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Stroke ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel + params.reduce((acc, val) => {
                return acc + `<br />${val.marker} ${dateTime.ds2time(val.value.d)}`;
            }, '');
        },
    });

    legend.push({
        top: '10%',
    });

    xAxis.push({
        name: 'Stroke',
        nameGap: 30,
        nameLocation: 'middle',
        max: 'dataMax',
    });
    yAxis.push({
        name: 'Time between strokes (mm:ss)',
        nameGap: 45,
        nameLocation: 'middle',
        axisLabel: {
            formatter: (val) => dateTime.ds2time(val),
        },
    });

    ids.forEach((id, iw) => {
        const workout = workouts.find((w) => w.id == id);
        const sd = strokeData.find((s) => s.id == id);
        let i = 1;

        dataset.push({
            dimension: [ 'stroke', 't' ],
            source: sd.data.reduce((acc, val) => {
                let lastTime = 0;
                return acc.concat(val.map((v) => {
                    const t = v.t - lastTime;
                    lastTime = v.t;

                    return {
                        stroke: i++,
                        d: t,
                    };
                }));
            }, []),
        });

        series.push({
            type: 'line',
            name: workout.date,
            datasetIndex: iw,
            showSymbol: false,
            lineStyle: {
                width: 1,
            },
            encode: {
                x: 'stroke',
                y: 't',
            },
            animation: false,
        });
    });

    return {
        tooltip,
        legend,
        xAxis,
        yAxis,
        dataset,
        series,
    };
};

const pacePerInterval = (ids) => {
    const dataset = [];
    const series = [];
    const yAxis = [];
    const tooltip = [];
    const xAxis = [];
    const legend = [];

    xAxis.push({
        type: 'value',
        name: 'Interval',
        nameGap: 30,
        nameLocation: 'middle',
    });

    legend.push({
        top: '10%',
    });

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Interval ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel + params.reduce((acc, val) => {
                return acc + `<br />${val.marker} ${dateTime.ds2time(val.value.pace)}`;
            }, '');
        },
    });

    yAxis.push({
        name: 'Pace (mm:ss)',
        nameGap: 45,
        nameLocation: 'middle',
        axisLabel: {
            formatter: (val) => dateTime.ds2time(val),
        },
        min: 850,
        inverse: true,
    });

    ids.forEach((id, iw) => {
        const workout = workouts.find((w) => w.id == id);

        dataset.push({
            dimension: [ 'interval', 'pace' ],
            source: workout.intervals.map((w, i) => ({
                interval: i+1,
                pace: 500 * (w.time / w.distance),
            })),
        });

        series.push({
            type: 'line',
            name: workout.date,
            datasetIndex: iw,
            encode: {
                x: 'interval',
                y: 'pace',
            },
            animation: false,
        });
    });

    return {
        tooltip,
        legend,
        xAxis,
        yAxis,
        dataset,
        series,
    };
};

const wattsPerStroke = (ids) => {
    const dataset = [];
    const xAxis = [];
    const yAxis = [];
    const series = [];
    const tooltip = [];
    const legend = [];
    const dataZoom = [];

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Stroke ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel + params.reduce((acc, val) => {
                return acc + `<br />${val.marker} ${val.value.w}W`;
            }, '');
        },
    });

    legend.push({
        top: '10%',
    });

    xAxis.push({
        name: 'Stroke',
        nameGap: 30,
        nameLocation: 'middle',
        max: 'dataMax',
    });
    yAxis.push({
        name: 'Watts per strokes (W)',
        nameGap: 45,
        nameLocation: 'middle',
    });

    ids.forEach((id, iw) => {
        const workout = workouts.find((w) => w.id == id);
        const sd = strokeData.find((s) => s.id == id);
        let i = 1;

        dataset.push({
            dimension: [ 'stroke', 'w' ],
            source: sd.data.reduce((acc, val) => {
                return acc.concat(val.map((v) => {
                    const w = v.t == 0 || v.d == 0 ? 0 : Math.trunc(2.8 / Math.pow((v.t/10) / (v.d/10), 3));

                    if (w == null || w == NaN) {
                        console.log(w, v);
                    }

                    return {
                        stroke: i++,
                        w: w,
                    };
                }));
            }, []),
        });

        series.push({
            type: 'line',
            name: workout.date,
            datasetIndex: iw,
            showSymbol: false,
            lineStyle: {
                width: 1,
            },
            encode: {
                x: 'stroke',
                y: 'w',
            },
            animation: false,
        });
    });

    dataZoom.push({
    });

    return {
        tooltip,
        legend,
        xAxis,
        yAxis,
        dataset,
        series,
        dataZoom,
    };
};

const cumulativeDistancePerInterval = (ids) => {
    const dataset = [];
    const series = [];
    const yAxis = [];
    const tooltip = [];
    const xAxis = [];
    const legend = [];

    xAxis.push({
        type: 'value',
        name: 'Interval',
        nameGap: 30,
        nameLocation: 'middle',
    });

    legend.push({
        top: '10%',
    });

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Interval ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel + params.reduce((acc, val) => {
                return acc + `<br />${val.marker} ${val.value.distance.toLocaleString()}m`;
            }, '');
        },
    });

    yAxis.push({
        name: 'Distance (mm)',
        nameGap: 45,
        nameLocation: 'middle',
        axisLabel: {
            formatter: (val) => val.toLocaleString() + 'm',
        },
    });

    ids.forEach((id, iw) => {
        const workout = workouts.find((w) => w.id == id);
        let lastDistance = 0;

        dataset.push({
            dimension: [ 'interval', 'distance' ],
            source: workout.intervals.map((w, i) => {
                const distance = lastDistance + w.distance;
                lastDistance += w.distance;

                return {
                    interval: i+1,
                    distance: distance,
                };
            }),
        });

        series.push({
            type: 'bar',
            name: workout.date,
            datasetIndex: iw,
            encode: {
                x: 'interval',
                y: 'distance',
            },
            animation: false,
        });
    });

    return {
        tooltip,
        legend,
        xAxis,
        yAxis,
        dataset,
        series,
    };
};

const bankedDistanceByInterval = (ids) => {
    const dataset = [];
    const series = [];
    const yAxis = [];
    const xAxis = [];
    const legend = [];
    const tooltip = [];

    legend.push({
        top: '10%',
    });

    tooltip.push({
        trigger: 'axis',
        axisPointer: {
            label: {
                formatter: (params) => {
                    return `Interval ${params.value}`;
                },
            }
        },
        formatter: (params) => {
            return params[0].axisValueLabel +
                `<br />${params[0].marker} ${params[0].value.bank}m`;
        },
    });

    xAxis.push({
        name: 'Interval',
        nameGap: 30,
        nameLocation: 'middle',
    });

    yAxis.push({
        name: 'Attempt 2 bank (m)',
        nameGap: 30,
        nameLocation: 'middle',
    });

    const numIntervals = workouts[0].intervals.length;
    const data = [];

    for (let i = 0; i < numIntervals; i++) {
        const attempt1 = workouts[0].intervals[i].distance;
        const attempt2 = workouts[1].intervals[i].distance;

        data.push({
            interval: i+1,
            bank: (i > 0 ? data[i-1].bank : 0) + attempt2 - attempt1,
        });
    }

    dataset.push({
        dimension: [ 'interval', 'bank' ],
        source: data,
    });

    series.push({
        type: 'bar',
        name: '2nd attempt bank',
        encode: {
            x: 'interval',
            y: 'bank',
        },
        animation: false,
    });

    return {
        tooltip,
        legend,
        xAxis,
        yAxis,
        dataset,
        series
    };
};

export const repeated = {
    interval_24_30_30: {
        strokesPerInterval: () => strokesPerInterval([ 40524237, 46414252 ]),
        distancePerInterval: () => distancePerInterval([ 40524237, 46414252 ]),

        cumulativeDistancePerStroke: () => cumulativeDistancePerStroke([ 40524237, 46414252 ]),
        cumulativeDistancePerInterval: () => cumulativeDistancePerInterval([ 40524237, 46414252 ]),

        distanceDeltaPerInterval: () => distanceDeltaPerInterval([ 40524237, 46414252 ]),
        distancePerStroke: () => distancePerStroke([ 40524237, 46414252 ]),
        timeDeltaPerStroke: () => timeDeltaPerStroke([ 40524237, 46414252 ]),

        pacePerInterval: () => pacePerInterval([ 40524237, 46414252 ]),
        wattsPerStroke: () => wattsPerStroke([ 40524237, 46414252 ]),

        bankedDistanceByInterval: () => bankedDistanceByInterval([ 40524237, 46414252 ]),
    }
};
